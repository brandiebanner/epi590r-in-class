---
title: "gtsummary in quarto"
author: Brandie Shackelford
format:
  html:
    theme: lux #I also like slate
execute:
  echo: false
---

------------------------------------------------------------------------

```{r}
#| message: false
library(tidyverse)
library(gtsummary)
nlsy_cols <- c("glasses", "eyesight", "sleep_wkdy", "sleep_wknd", 
               "id", "nsibs", "samp", "race_eth", "sex", "region", 
               "income", "res_1980", "res_2002", "age_bir")
nlsy <- read_csv(here::here("data", "raw", "nlsy.csv"), 
                 na = c("-1", "-2", "-3", "-4", "-5", "-998"),
                 skip = 1, col_names = nlsy_cols) |> 
  mutate(region_cat = factor(region, labels = c("Northeast", "North Central", "South", "West")),
         sex_cat = factor(sex, labels = c("Male", "Female")),
         race_eth_cat = factor(race_eth, labels = c("Hispanic", "Black", "Non-Black, Non-Hispanic")),
         eyesight_cat = factor(eyesight, labels = c("Excellent", "Very good", "Good", "Fair", "Poor")),
         glasses_cat = factor(glasses, labels = c("No", "Yes"))) 
```

# Customization of `tbl_summary()`

@tbl-race shows the key variables stratified by race.

```{r}
#| label: tbl-race
#| tbl-cap: "Key variables stratified by race"
tbl_summary(
  nlsy,
  by = race_eth_cat,
  include = c(sex_cat, region_cat,
              eyesight_cat, glasses, age_bir))
```

```{r}
median_sleep <- median(nlsy$sleep_wknd, na.rm = TRUE)
```

The median hours of sleep on the weekends was `r median_sleep`.

The mean hours of sleep on the weekends was `r round(mean(nlsy$sleep_wknd, na.rm = TRUE), 2)`.

```{r}
#| label: tbl-region
#| tbl-cap: "Key variables stratified by region"
tbl_summary(
  nlsy,
  by = region_cat,
  include = c(race_eth_cat, sex_cat,
              eyesight_cat, glasses, age_bir),
  label = list(
    race_eth_cat ~ "Race/ethnicity",
    sex_cat ~ "Sex at birth",
    eyesight_cat ~ "Eyesight",
    glasses ~ "Wears glasses",
    age_bir ~ "Age at first birth"
  ),
  missing_text = "Missing")
```

# **NLSY data**

*Blurb taken from https://www.nlsinfo.org/*

The NLS, sponsored by the U.S. Bureau of Labor Statistics, are nationally representative surveys that follow the same sample of individuals from specific birth cohorts over time. The surveys collect data on labor market activity, schooling, fertility, program participation, health, and much more. Select a cohort below to explore detailed information.

```{r}
#| label: tbl-sex
#| tbl-cap: "Key variables stratified by sex"
tbl_summary(
  nlsy,
  by = sex_cat,
  include = c(race_eth_cat, region_cat, eyesight_cat, glasses, age_bir)) 
```

```{r}
#| label: tbl-descr
#| tbl-cap: "Descriptive statistics"
#| output-location: slide
tabledescr <- tbl_summary(
  nlsy,
  by = sex_cat,
  include = c(race_eth_cat, region_cat,
              eyesight_cat, glasses, age_bir)) |> 
  add_overall(last = TRUE)
tabledescr

overallagebirth <-inline_text(tabledescr, variable = "age_bir", column = "stat_0")
```

The age of first birth overall was `r overallagebirth` (@tbl-descr).

```{r}
#| label: tbl-sleep
#| tbl-cap: "Sleep statistics"
#| output-location: slide
tablesleep <- tbl_summary(
  nlsy,
  by = sex_cat,
  include = c(sleep_wknd, eyesight_cat),
  ) |> 
  add_overall(last = TRUE)
tablesleep

mediansleep <-inline_text(tablesleep, variable = "sleep_wknd", column = "stat_0")

excellent_eyesight <-inline_text(tablesleep, variable = "eyesight_cat", level = "Excellent", column = "stat_0")
```

The overall median sleep (IQR) on the weekends was `r mediansleep` (@tbl-sleep).

The people with excellent eyesight was `r excellent_eyesight` (@tbl-sleep).
